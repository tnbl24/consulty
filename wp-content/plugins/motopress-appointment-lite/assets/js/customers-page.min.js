!function(){"use strict";!function(t,e){class n{constructor(t){this.$element=t,this.type=t.data("type"),this.$element.attr("data-inited","true")}}let s="/motopress/appointment/v1";function i(t,e={}){return function(t,e={},n="GET"){return new Promise(((i,o)=>{wp.apiRequest({path:s+t,type:n,data:e}).done((t=>i(t))).fail(((t,e)=>{let n="parsererror";n=t.responseJSON&&t.responseJSON.message?t.responseJSON.message:`Status: ${e}`,"parsererror"==n&&(n="REST request failed. Maybe PHP error on the server side. Check PHP logs."),o(new Error(n))}))}))}(t,e,"GET")}class o{constructor(){this.settings=this.getDefaults(),this.loadingPromise=this.load()}getDefaults(){return{plugin_name:"Appointment Booking",today:"2030-01-01",business_name:"",default_time_step:30,default_booking_status:"confirmed",confirmation_mode:"auto",terms_page_id_for_acceptance:0,allow_multibooking:!1,allow_coupons:!1,allow_customer_account_creation:!1,country:"",currency:"EUR",currency_symbol:"&euro;",currency_position:"before",decimal_separator:".",thousand_separator:",",number_of_decimals:2,timezone:"UTC",date_format:"F j, Y",time_format:"H:i",week_starts_on:0,thumbnail_size:{width:150,height:150},flatpickr_locale:"en",enable_payments:!1,active_gateways:[],payment_received_page_url:"",failed_transaction_page_url:"",default_payment_gateway:""}}load(){return new Promise(((t,e)=>{i("/settings").then((t=>this.settings=t),(t=>console.error("Unable to load public settings.",t))).finally((()=>t(this.settings)))}))}ready(){return this.loadingPromise}getPluginName(){return this.settings.plugin_name}getBusinessDate(){return this.settings.today}getBusinessName(){return this.settings.business_name}getTimeStep(){return this.settings.default_time_step}getDefaultBookingStatus(){return this.settings.default_booking_status}getConfirmationMode(){return this.settings.confirmation_mode}getTermsPageIdForAcceptance(){return this.settings.terms_page_id_for_acceptance}isMultibookingEnabled(){return this.settings.allow_multibooking}isCouponsEnabled(){return this.settings.allow_coupons}isAllowCustomerAccountCreation(){return this.settings.allow_customer_account_creation}getCountry(){return this.settings.country}getCurrency(){return this.settings.currency}getCurrencySymbol(){return this.settings.currency_symbol}getCurrencyPosition(){return this.settings.currency_position}getDecimalSeparator(){return this.settings.decimal_separator}getThousandSeparator(){return this.settings.thousand_separator}getDecimalsCount(){return this.settings.number_of_decimals}getTimezone(){return this.settings.timezone}getDateFormat(){return this.settings.date_format}getTimeFormat(){return this.settings.time_format}getFirstDayOfWeek(){return this.settings.week_starts_on}getThumbnailSize(){return this.settings.thumbnail_size}getFlatpickrLocale(){return this.settings.flatpickr_locale}isPaymentsEnabled(){return this.settings.enable_payments}getActiveGateways(){return this.settings.active_gateways}getPaymentReceivedPageUrl(){return this.settings.payment_received_page_url}getFailedTransactionPageUrl(){return this.settings.failed_transaction_page_url}getDefaultPaymentGateway(){return this.settings.default_payment_gateway}}class r{constructor(){this.settingsCtrl=new o,this.loadingPromise=this.load()}load(){return Promise.all([this.settingsCtrl.ready()]).then((()=>this))}ready(){return this.loadingPromise}settings(){return this.settingsCtrl}static getInstance(){return null==r.instance&&(r.instance=new r),r.instance}}const a="undefined"!=typeof wp&&wp.i18n&&wp.i18n.__?wp.i18n.__:(t,e="")=>t,p="undefined"!=typeof wp&&wp.i18n&&wp.i18n._x?wp.i18n._x:(t,e,n="")=>t;"undefined"!=typeof wp&&wp.i18n&&wp.i18n.sprintf&&wp.i18n.sprintf,a("Sun","motopress-appointment"),a("Mon","motopress-appointment"),a("Tue","motopress-appointment"),a("Wed","motopress-appointment"),a("Thu","motopress-appointment"),a("Fri","motopress-appointment"),a("Sat","motopress-appointment"),a("Sunday","motopress-appointment"),a("Monday","motopress-appointment"),a("Tuesday","motopress-appointment"),a("Wednesday","motopress-appointment"),a("Thursday","motopress-appointment"),a("Friday","motopress-appointment"),a("Saturday","motopress-appointment"),a("Jan","motopress-appointment"),a("Feb","motopress-appointment"),a("Mar","motopress-appointment"),a("Apr","motopress-appointment"),p("May","Month (short)","motopress-appointment"),a("Jun","motopress-appointment"),a("Jul","motopress-appointment"),a("Aug","motopress-appointment"),a("Sep","motopress-appointment"),a("Oct","motopress-appointment"),a("Nov","motopress-appointment"),a("Dec","motopress-appointment"),a("January","motopress-appointment"),a("February","motopress-appointment"),a("March","motopress-appointment"),a("April","motopress-appointment"),p("May","Month","motopress-appointment"),a("June","motopress-appointment"),a("July","motopress-appointment"),a("August","motopress-appointment"),a("September","motopress-appointment"),a("October","motopress-appointment"),a("November","motopress-appointment"),a("December","motopress-appointment"),r.getInstance().settings().getFirstDayOfWeek();class m extends n{constructor(n){super(n),this.$input=n.find("input").first(),function(n){const s=jQuery("<span/>",{id:n.attr("id")+"_error",class:"mpa-phone-field-error mpa-hide",text:a("Phone number is invalid.","motopress-appointment")});n.after("<br>",s);const i=t(n[0],{separateDialCode:!0,initialCountry:e.settings.country,hiddenInput:n.attr("name"),utilsScript:e.urls.plugin+"assets/js/intl-tel-input-17.0.19/js/utils.js"});i.promise.then((()=>{n.val()&&o(),n.on("countrychange",(t=>{o()})),n.on("input",(t=>{o()}))}));const o=()=>{i.isValidNumber()?(jQuery("input[type='hidden'][name='"+n.attr("name")+"']").val(i.getNumber(intlTelInputUtils.numberFormat.E164)),n.removeClass("mpa-phone-number--invalid"),s.addClass("mpa-hide")):(n.addClass("mpa-phone-number--invalid"),s.removeClass("mpa-hide"))}}(this.$input)}}new class{constructor(){this.setupFields(jQuery(".mpa-ctrl:not([data-inited])"))}setupFields(t){t.each((function(t,e){let n=jQuery(e);if("phone"===n.attr("data-type"))new m(n)}))}}}(intlTelInput,mpaData)}();
